<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt"?>

<rfc
 category="std"
 docName="draft-cel-nfsv4-rpc-over-quicv1-latest"
 ipr="trust200902"
 obsoletes=""
 scripts="Common,Latin"
 sortRefs="true"
 submissionType="IETF"
 symRefs="true"
 tocDepth="2"
 tocInclude="true"
 updates=""
 version="3"
 xml:lang="en"
 xmlns:xi="http://www.w3.org/2001/XInclude">

<front>

<title abbrev="RPC Over QUICv1">
Remote Procedure Call Over QUIC Version 1
</title>

<seriesInfo name="Internet-Draft" value="draft-cel-nfsv4-rpc-over-quicv1-latest"/>

<author initials="J. B." surname="Fields" fullname="J. Bruce Fields">
<organization abbrev="Red Hat" showOnFrontPage="true">
Red Hat
</organization>
<address>
<postal>
<street/>
<city/>
<region/>
<code/>
<country>United States of America</country>
</postal>
<email>bfields@redhat.com</email>
</address>
</author>

<author initials="C." surname="Lever" fullname="Charles Lever" role="editor">
<organization abbrev="Oracle" showOnFrontPage="true">
Oracle Corporation
</organization>
<address>
<postal>
<street/>
<city/>
<region/>
<code/>
<country>United States of America</country>
</postal>
<email>chuck.lever@oracle.com</email>
</address>
</author>

<date/>

<area>Transport</area>
<workgroup>Network File System Version 4</workgroup>

<abstract>
<t>
This document specifies a protocol for conveying Remote Procedure
(RPC) messages on QUIC version 1 connections.
It requires no revision to application RPC protocols or the RPC protocol itself.
</t>
</abstract>

<note removeInRFC="true">
<t>
Discussion of this draft occurs
on the NFSv4 working group mailing list (nfsv4@ietf.org),
archived at
<eref target="https://mailarchive.ietf.org/arch/browse/nfsv4/"/>.
Working Group information is available at
<eref target="https://datatracker.ietf.org/wg/nfsv4/about/"/>.
</t>
<t>
Submit suggestions and changes as pull requests at
<eref target="https://github.com/chucklever/i-d-rpc-over-quicv1"/>.
Instructions are on that page.
</t>
</note>

</front>

<middle>

<section
 anchor="section_8E36B184-2224-44F5-BB40-3A28AABD2919"
 numbered="true"
 removeInRFC="false"
 toc="default">
<name>Introduction</name>
<t>
This RFC explains how to layer RPC protocols, including especially NFS, on top
of QUIC version 1.
</t>
<aside>
<t>
Explain motivations:
</t>
<ul>
<li>TLS</li>
<li>Multiple streams--though applications are speculative at this point.
  (Maybe they will allow more sophisticated prioritization of traffic
  without the overhead of multiple TCP connections?)</li>
<li>Lower-latency connection setup--though NFS connections are typically
  long-lived.</li>
<li>Likely SMB adoption of QUIC should make QUIC implementations widely
  available.</li>
</ul>
</aside>
</section>

<section
 anchor="section_3430C86D-BB5E-46C3-98A8-1FF8BAADFD73"
 numbered="true"
 removeInRFC="false"
 toc="default">
<name>Requirements Language</name>
<t>
The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
"<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>",
"<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>",
"<bcp14>SHOULD NOT</bcp14>",
"<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
"<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>"
in this document are to be interpreted
as described in BCP&nbsp;14
<xref target="RFC2119" format="default" sectionFormat="of"/>
<xref target="RFC8174" format="default" sectionFormat="of"/>
when, and only when, they appear in all capitals, as shown here.
</t>

</section>

<section>
<name>TLS</name>

<t>
TLS is a mandatory component of QUIC.  All of
<xref target="I-D.ietf-nfsv4-rpc-tls"/> applies to RPC over QUIC as well, with
the exception of the STARTTLS mechanism described in section 4.1.
</t>

</section>

<section>
<name>Formatting of RPC messages over QUIC</name>
<t>
Record marking is exactly as in TCP; see
<xref target="RFC5531" section="11"/>.
</t>

<aside>
<t>
Discussion: This is the simplest thing to do.  Open question whether we
should do something more complicated that adds RDMA-like features or at
least provides some minimal help with data alignment.  Possibilities might
include a single additional integer giving the offset of a payload, serving
only as a hint; or reference additional streams in the same connection for
payloads; or even looking into full RDMA--long-term there may be interest in
supporting RDMA over QUIC, and we may be able to piggyback on that effort.
</t>
</aside>
</section>

<section>
<name>QUIC Connections and Streams</name>
<t>
QUIC supports multiple streams of data per connection.
</t>
<t>
When upper-layer protocol specifications refer to a "connection", this should
be understood to apply to a QUIC connection, not to a single stream.  For
example, in the case of NFSv4.1 <xref target="RFC8881"/>, a BIND_CONN_TO_SESSION
operation binds the entire connection and does not need to be repeated for
each stream.
</t>
<t>
An RPC reply MUST be sent over the same connection and stream as the call
it replies to.
</t>
<t>
In protocols such as NFSv4.1 <xref target="RFC8881"/> that support bidrectional
RPCs, forechannel RPCs MUST be sent over a client-initiated bidirectional
stream and backchannel RPCs MUST be sent over a server-initiated bidirectional
stream.
</t>
<t>
Otherwise, unless the protocol specifies otherwise, RPC callers are free
to use streams as they wish, and responders are required to allow callers
to do so.
</t>
<aside>
<t>NFS requirement on resends: QUIC allows reconnecting using the same
connection ID, so isn't breaking/reconnection somewhat ambiguous?  When
can a server drop or a client resend?
</t>
</aside>
</section>

<section
 anchor="section_219EA538-829F-49D1-828A-4F9AC2D056D4"
 numbered="true"
 removeInRFC="true"
 toc="default">
<name>Implementation Status</name>
<t>
This section records the status of known implementations of the
protocol defined by this specification at the time of posting of
this Internet-Draft, and is based on a proposal described in
<xref target="RFC7942" format="default" sectionFormat="of"/>.
The description of implementations in this section is
intended to assist the IETF in its decision processes in
progressing drafts to RFCs.
</t>
<t>
Please note that the listing of any individual implementation here
does not imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information
presented here that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a
catalog of available implementations or their features.
Readers are advised to note that other implementations may exist.
</t>
<t>
There are no known implementations of RPC-over-QUICv1
as it is described in the current document.
</t>

</section>

<section
 anchor="section_E07B07F5-9681-4FE5-AEB9-893F61BABF1D"
 numbered="true"
 removeInRFC="false"
 toc="default">
<name>Security Considerations</name>
<t>
</t>
</section>

<section
 anchor="section_BBEF88FF-B166-41B1-BCE0-9707E253F7D3"
 numbered="true"
 removeInRFC="false"
 toc="default">
<name>IANA Considerations</name>
<t>
RFC Editor: In the following subsections,
please replace RFC-TBD with the RFC number assigned to this document.
Furthermore, please remove this Editor's Note
before this document is published.
</t>

<section
 anchor="section_196DBE70-A96E-411F-9C2C-C053FD589449"
 numbered="true"
 removeInRFC="false"
 toc="default">
<name>Netids for RPC-Over-QUICv1</name>
<t>
Each new RPC transport is assigned one or more RPC "netid" strings.
These strings are an rpcbind
<xref target="RFC1833"/>
string naming the underlying transport protocol,
appropriate message framing,
and
the format of service addresses and ports,
among other things.
</t>
<t>
The authors request that IANA allocate
the following "Netid" registry strings in the "ONC RPC Netid"
registry, as defined in
<xref target="RFC5666"/>:
</t>
<sourcecode name="" type="" markers="true">
<![CDATA[
      NC_QUIC "quic"
      NC_QUIC6 "quic6"
]]>
</sourcecode>
<t>
These netids MUST be used for any transport satisfying
the requirements described in the current document.
The "quic" netid is to be used when IPv4 addressing
is employed by the underlying transport,
and "quic6" for IPv6 addressing.
IANA should use the current document (RFC-TBD)
as the reference for the new entries.
</t>
</section>

</section>

</middle>

<back>

<references>
<name>References</name>

<references>
<name>Normative References</name>

<xi:include
 xmlns:xi="http://www.w3.org/2001/XInclude"
 href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.1833.xml"/>
<xi:include
 xmlns:xi="http://www.w3.org/2001/XInclude"
 href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
<xi:include
 xmlns:xi="http://www.w3.org/2001/XInclude"
 href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5666.xml"/>
<xi:include
 xmlns:xi="http://www.w3.org/2001/XInclude"
 href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7942.xml"/>
<xi:include
 xmlns:xi="http://www.w3.org/2001/XInclude"
 href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
<xi:include
 xmlns:xi="http://www.w3.org/2001/XInclude"
 href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.draft-ietf-nfsv4-rpc-tls-11.xml"/>

<xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
 href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5531.xml"/>
</references>

<references>
<name>Informative References</name>

<xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
 href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8881.xml"/>

</references>

</references>

<section
 anchor="section_C1D8489F-D9D6-4340-ADB8-4021D8CB18B8"
 numbered="false"
 removeInRFC="false"
 toc="default">
<name>Acknowledgments</name>
<t>
The editor is grateful to
<contact fullname="Bill Baker"/>,
<contact fullname="Greg Marsden"/>,
and
<contact fullname="Martin Thomson"/>
for their input and support.
</t>
<t>
Special thanks to
Transport Area Directors
<contact fullname="Martin Duke"/>
and
<contact fullname="Zaheduzzaman Sarker"/>,
NFSV4 Working Group Chairs
<contact fullname="David Noveck"/>
and
<contact fullname="Brian Pawlowski"/>,
and
NFSV4 Working Group Secretary
<contact fullname="Thomas Haynes"/>
for their guidance and oversight.
</t>
</section>

</back>

</rfc>
